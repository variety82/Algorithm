# 그래프 이론

___

### 서로소 집합 자료구조

- union

  두개의 집합을 하나로 합치는 연산

- find

  특정한 원소가 속한 집합이 어떤 집합인지 알려주는 연산

서로소 집합 자료구조를 구현할 때는 트리 자료구조를 이용하여 집합을 표현한다.

알고리즘은 다음과 같다

1. union 연산을 확인하여, 서로 연결된 두 노드 A,B를 확인한다.

   1.1 A와 B의 루트 노드 A' , B' 을 각각 찾는다.

   1.2 A'을 B'의 부모 노드로 설정한다

1. 모든 union 연산을 처리할 때까지 1번의 과정을 반복한다.

초기 단계에서는 노드의 개수 크기의 부모 테이블을 초기화 한다. 이때 모든 원소가 자기 자신을 부모로 가지도록 설정한다. 여기서 유의할 점은 부모테이블엔 말 그대로 부모에 대한 정보만을 담고있어서 실제로 루트를 확인 할 때는 재귀적으로 거슬러 올라가 찾아야 한다.

```python
# 서로소 집합 알고리즘 소스코드

def find_parent(parent, x):
    #루트 노드가 아니라면, 루트 노드를 찾을 때까지 재귀적으로 호출
    if parent[x]!=x:
        return find_parent(parent,parent[x])
    return x

def union_parent(parent,a,b):
    a=find_parent(parent,a)
    b=find_parent(parent,b)
    if a<b:
        parent[b]=a
    else:
        parent[a]=b
```

그러나 위와 같은 경우 find함수가 최악의 경우 시간복잡도가 O(V)가 될 수 있다.

예를 들면, 

| 노드번호 | 1    | 2    | 3    | 4    | 5    |
| :------: | ---- | ---- | ---- | ---- | ---- |
|   부모   | 1    | 1    | 2    | 3    | 4    |

위와 같은 경우 1부터 5까지 모든 원소가 루트 노드로 1을 가지지만 순서대로 연결이 되어있어 5의 루트를 찾기 위해서는 순서대로 부모 노드를 거슬러 올라가야하므로 최대 O(V)의 시간이 소모된다.

이를 개선하기 위해 경로 압축 기법을 사용 할 수 있다, 경로 압축은 find 함수를 재귀적으로 호출한 뒤에 부모 테이블값을 갱신하는 기법이다. 

```python
# 경로 압축 기법 소스코드
def find_parent(parent,x):
    if parent[x]!=x:
        parent[x]=find_parent(parent,parent[x])
    return parent[x]
```

### 서로소 집합을 활용한 사이클 판별

서로소 집합은 무방향 그래프 내에서의 사이클을 판별할 때 사용가능하다.

알고리즘은 아래와 같다.

1. 각 간선을 확인하며 두 노드의 루트 노드를 확인한다.
   1. 루트 노드가 서로 다르다면 두 노드에 대하여 union 연산을 수행한다. 
   1. 루트 노드가 서로 같다면 사이크링 발생한 것이다. 
1. 그래프에 포함되어 있는 모든 간선에 대하여 1번 과정을 반복한다.

초기 단계에서는 모든 노드에 대하여 자기 자신을 부모로 설정하는 형태로 부모 테이블을 초기화 한다.

```python
cycle=False #싸이클 발생 여부
for i in range(e):
    if find_parent(parent,a)==find_parent(parent,b):
        cycle=True
        break # 싸이클이 발생하면 종료
    else:
        union_parent(parent,a,b)
    
```

